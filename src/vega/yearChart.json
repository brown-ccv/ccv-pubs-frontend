{
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "autosize": "pad",
  "padding": 5,
  "height": 200,
  "title": {
    "text": {
      "signal": "changeTitle"
    },
    "frame": "group"
  },
  "style": "cell",
  "data": [
    {
      "name": "source_0",
      "values": [
        {
          "month": "9",
          "year": 2017
        },
        {
          "month": "9",
          "year": 2017
        },
        {
          "month": "9",
          "year": 2017
        },
        {
          "month": "9",
          "year": 2017
        },
        {
          "month": "5",
          "year": 2018
        },
        {
          "month": "5",
          "year": 2018
        },
        {
          "month": "Missing",
          "year": 2017
        },
        {
          "month": "4",
          "year": 2017
        },
        {
          "month": "4",
          "year": 2017
        },
        {
          "month": "3",
          "year": 2017
        },
        {
          "month": "1",
          "year": 2017
        },
        {
          "month": "1",
          "year": 2017
        },
        {
          "month": "2",
          "year": 2017
        },
        {
          "month": "2",
          "year": 2017
        },
        {
          "month": "4",
          "year": 2016
        },
        {
          "month": "4",
          "year": 2016
        },
        {
          "month": "1",
          "year": 2016
        },
        {
          "month": "Missing",
          "year": 2016
        },
        {
          "month": "11",
          "year": 2016
        },
        {
          "month": "Missing",
          "year": 2016
        },
        {
          "month": "8",
          "year": 2016
        },
        {
          "month": "10",
          "year": 2016
        },
        {
          "month": "2",
          "year": 2016
        },
        {
          "month": "3",
          "year": 2016
        },
        {
          "month": "1",
          "year": 2016
        },
        {
          "month": "4",
          "year": 2016
        },
        {
          "month": "1",
          "year": 2017
        },
        {
          "month": "3",
          "year": 2016
        },
        {
          "month": "1",
          "year": 2017
        },
        {
          "month": "6",
          "year": 2016
        },
        {
          "month": "8",
          "year": 2016
        },
        {
          "month": "10",
          "year": 2016
        },
        {
          "month": "4",
          "year": 2016
        },
        {
          "month": "2",
          "year": 2016
        },
        {
          "month": "6",
          "year": 2016
        },
        {
          "month": "3",
          "year": 2016
        },
        {
          "month": "3",
          "year": 2016
        },
        {
          "month": "12",
          "year": 2014
        },
        {
          "month": "12",
          "year": 2017
        },
        {
          "month": "3",
          "year": 2015
        },
        {
          "month": "3",
          "year": 2015
        },
        {
          "month": "4",
          "year": 2015
        },
        {
          "month": "4",
          "year": 2015
        },
        {
          "month": "Missing",
          "year": 2015
        },
        {
          "month": "5",
          "year": 2014
        },
        {
          "month": "2",
          "year": 2015
        },
        {
          "month": "3",
          "year": 2014
        },
        {
          "month": "Missing",
          "year": 2014
        },
        {
          "month": "11",
          "year": 2014
        },
        {
          "month": "8",
          "year": 2014
        },
        {
          "month": "8",
          "year": 2014
        },
        {
          "month": "Missing",
          "year": 2014
        },
        {
          "month": "Missing",
          "year": 2014
        },
        {
          "month": "7",
          "year": 2014
        },
        {
          "month": "3",
          "year": 2014
        },
        {
          "month": "4",
          "year": 2014
        },
        {
          "month": "6",
          "year": 2014
        },
        {
          "month": "6",
          "year": 2014
        },
        {
          "month": "6",
          "year": 2014
        },
        {
          "month": "6",
          "year": 2014
        },
        {
          "month": "6",
          "year": 2014
        },
        {
          "month": "5",
          "year": 2014
        },
        {
          "month": "4",
          "year": 2014
        },
        {
          "month": "12",
          "year": 2013
        },
        {
          "month": "4",
          "year": 2014
        },
        {
          "month": "3",
          "year": 2014
        },
        {
          "month": "12",
          "year": 2013
        },
        {
          "month": "3",
          "year": 2014
        },
        {
          "month": "3",
          "year": 2014
        },
        {
          "month": "3",
          "year": 2014
        },
        {
          "month": "3",
          "year": 2014
        },
        {
          "month": "10",
          "year": 2013
        },
        {
          "month": "2",
          "year": 2014
        },
        {
          "month": "2",
          "year": 2014
        },
        {
          "month": "1",
          "year": 2014
        },
        {
          "month": "1",
          "year": 2014
        },
        {
          "month": "12",
          "year": 2013
        },
        {
          "month": "6",
          "year": 2018
        },
        {
          "month": "6",
          "year": 2018
        },
        {
          "month": "5",
          "year": 2018
        },
        {
          "month": "11",
          "year": 2018
        },
        {
          "month": "4",
          "year": 2018
        },
        {
          "month": "Missing",
          "year": 2018
        },
        {
          "month": "9",
          "year": 2016
        },
        {
          "month": "2",
          "year": 2016
        },
        {
          "month": "8",
          "year": 2015
        },
        {
          "month": "2",
          "year": 2015
        },
        {
          "month": "5",
          "year": 2015
        },
        {
          "month": "5",
          "year": 2015
        },
        {
          "month": "3",
          "year": 2018
        },
        {
          "month": "12",
          "year": 2017
        },
        {
          "month": "8",
          "year": 2017
        },
        {
          "month": "7",
          "year": 2017
        },
        {
          "month": "5",
          "year": 2019
        },
        {
          "month": "3",
          "year": 2016
        },
        {
          "month": "Missing",
          "year": 2016
        },
        {
          "month": "Missing",
          "year": 2016
        },
        {
          "month": "10",
          "year": 2014
        },
        {
          "month": "11",
          "year": 2014
        },
        {
          "month": "Missing",
          "year": 2015
        },
        {
          "month": "11",
          "year": 2015
        },
        {
          "month": "Missing",
          "year": 2015
        },
        {
          "month": "10",
          "year": 2015
        },
        {
          "month": "9",
          "year": 2015
        },
        {
          "month": "10",
          "year": 2015
        },
        {
          "month": "7",
          "year": 2015
        },
        {
          "month": "7",
          "year": 2015
        },
        {
          "month": "9",
          "year": 2014
        },
        {
          "month": "Missing",
          "year": 2014
        },
        {
          "month": "6",
          "year": 2014
        },
        {
          "month": "4",
          "year": 2018
        },
        {
          "month": "2",
          "year": 2018
        },
        {
          "month": "10",
          "year": 2018
        },
        {
          "month": "4",
          "year": 2018
        },
        {
          "month": "6",
          "year": 2017
        },
        {
          "month": "3",
          "year": 2018
        },
        {
          "month": "2",
          "year": 2018
        },
        {
          "month": "4",
          "year": 2018
        },
        {
          "month": "9",
          "year": 2018
        },
        {
          "month": "7",
          "year": 2018
        },
        {
          "month": "6",
          "year": 2018
        },
        {
          "month": "3",
          "year": 2018
        },
        {
          "month": "8",
          "year": 2016
        },
        {
          "month": "Missing",
          "year": 2018
        },
        {
          "month": "3",
          "year": 2018
        },
        {
          "month": "6",
          "year": 2018
        },
        {
          "month": "3",
          "year": 2018
        },
        {
          "month": "4",
          "year": 2019
        },
        {
          "month": "2",
          "year": 2017
        },
        {
          "month": "2",
          "year": 2017
        },
        {
          "month": "3",
          "year": 2017
        },
        {
          "month": "8",
          "year": 2017
        },
        {
          "month": "4",
          "year": 2017
        },
        {
          "month": "2",
          "year": 2016
        },
        {
          "month": "8",
          "year": 2016
        },
        {
          "month": "7",
          "year": 2016
        },
        {
          "month": "5",
          "year": 2016
        },
        {
          "month": "3",
          "year": 2015
        },
        {
          "month": "3",
          "year": 2016
        },
        {
          "month": "9",
          "year": 2015
        },
        {
          "month": "10",
          "year": 2016
        },
        {
          "month": "1",
          "year": 2016
        },
        {
          "month": "11",
          "year": 2016
        },
        {
          "month": "2",
          "year": 2016
        },
        {
          "month": "3",
          "year": 2015
        },
        {
          "month": "9",
          "year": 2015
        },
        {
          "month": "1",
          "year": 2015
        },
        {
          "month": "12",
          "year": 2015
        },
        {
          "month": "2",
          "year": 2015
        },
        {
          "month": "1",
          "year": 2015
        },
        {
          "month": "3",
          "year": 2015
        },
        {
          "month": "6",
          "year": 2015
        },
        {
          "month": "8",
          "year": 2015
        },
        {
          "month": "9",
          "year": 2015
        },
        {
          "month": "11",
          "year": 2015
        },
        {
          "month": "4",
          "year": 2015
        },
        {
          "month": "3",
          "year": 2015
        },
        {
          "month": "8",
          "year": 2014
        },
        {
          "month": "Missing",
          "year": 2014
        },
        {
          "month": "3",
          "year": 2014
        },
        {
          "month": "Missing",
          "year": 2014
        },
        {
          "month": "8",
          "year": 2014
        },
        {
          "month": "7",
          "year": 2014
        },
        {
          "month": "12",
          "year": 2017
        },
        {
          "month": "10",
          "year": 2015
        },
        {
          "month": "6",
          "year": 2018
        },
        {
          "month": "7",
          "year": 2018
        },
        {
          "month": "7",
          "year": 2017
        },
        {
          "month": "Missing",
          "year": 2017
        },
        {
          "month": "9",
          "year": 2017
        },
        {
          "month": "8",
          "year": 2017
        },
        {
          "month": "8",
          "year": 2016
        },
        {
          "month": "8",
          "year": 2017
        },
        {
          "month": "2",
          "year": 2014
        },
        {
          "month": "12",
          "year": 2013
        }
      ]
    },
    {
      "name": "data_0",
      "source": "source_0",
      "transform": [
        {
          "type": "formula",
          "as": "intmonth",
          "expr": "parseInt(datum.month)"
        },
        {
          "type": "filter",
          "expr": "select ? select.xfield == datum.year : datum"
        },
        {
          "type": "formula",
          "as": "xfield",
          "expr": "select ? datum.month_date : datum.year"
        },
        {
          "type": "formula",
          "as": "month_date",
          "expr": "timeFormat(datetime(2000, datum.intmonth), '%b')"
        },
        {
          "type": "formula",
          "expr": "datum[\"month\"]===\"1\" ? 0 : datum[\"month\"]===\"2\" ? 1 : datum[\"month\"]===\"3\" ? 2 : datum[\"month\"]===\"4\" ? 3 : datum[\"month\"]===\"5\" ? 4 : datum[\"month\"]===\"6\" ? 5 : datum[\"month\"]===\"7\" ? 6 : datum[\"month\"]===\"8\" ? 7 : datum[\"month\"]===\"9\" ? 8 : datum[\"month\"]===\"10\" ? 9 : datum[\"month\"]===\"11\" ? 10 : datum[\"month\"]===\"12\" ? 11 : 12",
          "as": "x_month_sort_index"
        },
        {
          "type": "aggregate",
          "groupby": [
            "xfield"
          ],
          "ops": [
            "count"
          ],
          "fields": [
            null
          ],
          "as": [
            "__count"
          ]
        }
      ]
    }
  ],
  "signals": [
    {
      "name": "x_step",
      "value": 20
    },
    {
      "name": "width",
      "update": "bandspace(domain('x').length, 0.1, 0.05) * x_step"
    },
    {
      "name": "select",
      "value": null,
      "on": [
        {
          "events": "click",
          "update": "select ? null : datum"
        },
        {
          "events": "dblclick",
          "update": "null"
        }
      ]
    },
    {
      "name": "change",
      "update": "select ? 'Month' : 'Year' "
    },
    {
      "name": "changeTitle",
      "update": "select ? 'Number of Publications vs Month' : 'Number of Publications vs Year' "
    }
  ],
  "marks": [
    {
      "name": "marks",
      "type": "rect",
      "style": [
        "bar"
      ],
      "from": {
        "data": "data_0"
      },
      "encode": {
        "update": {
          "fill": {
            "value": "#00FFFF"
          },
          "stroke": {
            "value": "black"
          },
          "cursor": {
            "value": "pointer"
          },
          "tooltip": [
            {
              "test": "!select",
              "signal": "{\"Year\": ''+datum[\"xfield\"], \"Count of Records\": format(datum[\"__count\"], \"\")}"
            },
            {
              "signal": "{\"Month\": ''+datum[\"xfield\"], \"Count of Records\": format(datum[\"__count\"], \"\")}"
            }
          ],
          "x": {
            "scale": "x",
            "field": "xfield"
          },
          "width": {
            "scale": "x",
            "band": true
          },
          "y": {
            "scale": "y",
            "field": "__count"
          },
          "y2": {
            "scale": "y",
            "value": 0
          }
        }
      }
    }
  ],
  "scales": [
    {
      "name": "x",
      "type": "band",
      "domain": {
        "data": "data_0",
        "field": "xfield",
        "sort": {
          "field": "x_month_sort_index"
        }
      },
      "range": {
        "step": {
          "signal": "x_step"
        }
      },
      "paddingInner": 0.1,
      "paddingOuter": 0.05
    },
    {
      "name": "y",
      "type": "linear",
      "domain": {
        "data": "data_0",
        "field": "__count"
      },
      "range": [
        {
          "signal": "height"
        },
        0
      ],
      "nice": true,
      "zero": true
    }
  ],
  "axes": [
    {
      "scale": "x",
      "orient": "bottom",
      "grid": false,
      "title": {
        "signal": "change"
      },
      "labelAlign": "right",
      "labelAngle": 270,
      "labelBaseline": "middle",
      "zindex": 1,
      "encode": {
        "labels": {
          "update": {
            "text": {
              "signal": "datum.value"
            }
          }
        }
      }
    },
    {
      "scale": "y",
      "orient": "left",
      "grid": false,
      "title": "Count of Records",
      "labelOverlap": true,
      "tickCount": {
        "signal": "ceil(height/40)"
      },
      "zindex": 1
    },
    {
      "scale": "y",
      "orient": "left",
      "gridScale": "x",
      "grid": true,
      "tickCount": {
        "signal": "ceil(height/40)"
      },
      "domain": false,
      "labels": false,
      "maxExtent": 0,
      "minExtent": 0,
      "ticks": false,
      "zindex": 0
    }
  ],
  "config": {}
}
